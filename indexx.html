<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KuCoin Live Dashboard</title>
  <style>
    body {
      background-color: #0f172a;
      color: #e2e8f0;
      font-family: "Segoe UI", sans-serif;
      text-align: center;
      padding: 30px;
    }
    h1 {
      color: #38bdf8;
    }
    table {
      margin: 30px auto;
      border-collapse: collapse;
      width: 80%;
      background: #1e293b;
      border-radius: 10px;
      overflow: hidden;
    }
    th, td {
      padding: 10px;
      border-bottom: 1px solid #334155;
    }
    th {
      background: #0ea5e9;
      color: white;
    }
    tr:hover {
      background: #334155;
    }
  </style>
</head>
<body>
  <h1>ğŸ’¹ KuCoin Live Dashboard</h1>
  <p>CanlÄ± fiyat akÄ±ÅŸÄ± (BTC, ETH, SOL, KCS, DOGE)</p>

  <table id="priceTable">
    <thead>
      <tr>
        <th>Parite</th>
        <th>Fiyat</th>
        <th>Zaman</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const ws = new WebSocket("wss://ws-api.kucoin.com/endpoint");

    const symbols = ["BTC-USDT", "ETH-USDT", "SOL-USDT", "KCS-USDT", "DOGE-USDT"];
    const tableBody = document.querySelector("#priceTable tbody");

    ws.onopen = () => {
      console.log("âœ… KuCoin WS baÄŸlantÄ±sÄ± kuruldu.");
      ws.send(JSON.stringify({
        id: Date.now(),
        type: "subscribe",
        topic: "/market/ticker:BTC-USDT,ETH-USDT,SOL-USDT,KCS-USDT,DOGE-USDT",
        privateChannel: false,
        response: true
      }));
    };

    ws.onmessage = (event) => {
      const data = JSON.parse(event.data);
      if (data.topic && data.data) {
        const ticker = data.data;
        const symbol = data.topic.split(":")[1];
        const price = parseFloat(ticker.price).toFixed(4);
        const time = new Date().toLocaleTimeString();

        const existingRow = document.getElementById(symbol);
        if (existingRow) {
          existingRow.cells[1].textContent = price;
          existingRow.cells[2].textContent = time;
        } else {
          const row = document.createElement("tr");
          row.id = symbol;
          row.innerHTML = `<td>${symbol}</td><td>${price}</td><td>${time}</td>`;
          tableBody.appendChild(row);
        }
      }
    };

    ws.onerror = (err) => console.error("âŒ WS hata:", err);
    ws.onclose = () => console.warn("âš ï¸ WS baÄŸlantÄ±sÄ± kapandÄ±, yeniden baÄŸlanÄ±yor...");
  </script>
</body>
</html>
